#+TITLE: rfnash's Emacs configuration
#+OPTIONS: toc:4 h:4
* About this file
<<babel-init>>
TODO: write something about this file.
* Historical
  :PROPERTIES:
  :CREATED:  [2014-10-07 Tue 13:22]
  :END:
** init.el
   For historical reference
   #+begin_src emacs-lisp :tangle no
     (mapc 'load (directory-files "~/.emacs.d/conf.d/" t "^[^#!].*\.el$"))
     (server-start)
     (custom-set-variables
     custom-set-variables was added by Custom.
     If you edit it by hand, you could mess it up, so be careful.
     Your init file should contain only one such instance.
     If there is more than one, they won't work right.
     '(helm-adaptative-mode t nil (helm-adaptative))
     '(helm-adaptive-history-length 1000)
     '(helm-ff-file-name-history-use-recentf t)
     (custom-set-faces
     custom-set-faces was added by Custom.
     If you edit it by hand, you could mess it up, so be careful.
     Your init file should contain only one such instance.
     If there is more than one, they won't work right.
     '(mode-line ((t (:foreground "#030303" :background "#bdbdbd" :box nil))))
     '(mode-line-inactive ((t (:foreground "#f9f9f9" :background "#666666" :box nil)))))

     ;; Various settings from emacs kicker
     ;; (https://github.com/dimitri/emacs-kicker)

     ;; on to the visual settings


     (setq inhibit-splash-screen t)               ; no splash screen, thanks
     (line-number-mode t)                 ; have line numbers and
     (column-number-mode t)                       ; column numbers in the mode line

     (tool-bar-mode -1)                           ; no tool bar with icons
     (scroll-bar-mode -1)                 ; no scroll bars
     (menu-bar-mode -1)                      ; no menu bar

     (global-hl-line-mode)                        ; highlight current line
     (global-linum-mode 1)                        ; add line numbers on the left

     ;; full screen
     (defun fullscreen ()
       (interactive)
       (set-frame-parameter nil 'fullscreen
                         (if (frame-parameter nil 'fullscreen) nil 'fullboth)))
     (global-set-key [f11] 'fullscreen)

     ;; Use the clipboard, pretty please, so that copy/paste "works"
     (setq x-select-enable-clipboard t)

     ;; Navigate currently visible windows with M-<arrows>
     (windmove-default-keybindings 'meta)
     (setq windmove-wrap-around t)

     ;; winner-mode provides C-<left> to get back to previous window layout
     (winner-mode 1)

     ;; whenever an external process changes a file underneath emacs, and there
     ;; was no unsaved changes in the corresponding buffer, just revert its
     ;; content to reflect what's on-disk.
     (global-auto-revert-mode 1)

     ;; C-x C-j opens dired with the cursor right on the file you're editing
     (require 'dired-x)

     (set-face-attribute 'default nil :family "Liberation Mono for Powerline" :height 120)


     ;; From emacsredux
     (defun eval-and-replace ()
       "Replace the preceding sexp with its value."
       (interactive)
       (backward-kill-sexp)
       (condition-case nil
           (prin1 (eval (read (current-kill 0)))
               (current-buffer))
         (error (message "Invalid expression")
             (insert (current-kill 0)))))
     (global-set-key (kbd "C-c e") 'eval-end-replace)

     ;; from whattheemacsd.com

     ;; Write backup files to own directory
     (setq backup-directory-alist
           `(("." . ,(expand-file-name
                   (concat user-emacs-directory "backups")))))

     ;; Make backups of files, even when they're in version control
     (setq vc-make-backup-files t)

     ;; Save point position between sessions
     (require 'saveplace)
     (setq-default save-place t)
     (setq save-place-file (expand-file-name ".places" user-emacs-directory))

     (defun cleanup-buffer-safe ()
       "Perform a bunch of safe operations on the whitespace content of a buffer.
     Does not indent buffer, because it is used for a before-save-hook, and that
     might be bad.
     TODO: Will screw up makefiles by changing tabs to whitespace."
       (interactive)
       ;; (untabify (point-min) (point-max))
       (delete-trailing-whitespace)
       (set-buffer-file-coding-system 'utf-8))

     ;; Various superfluous white-space. Just say no.
     (add-hook 'before-save-hook 'cleanup-buffer-safe)

     (defun cleanup-buffer ()
       "Perform a bunch of operations on the whitespace content of a buffer.
     Including indent-buffer, which should not be called automatically on save."
       (interactive)
       (cleanup-buffer-safe)
       (indent-region (point-min) (point-max)))

     (global-set-key (kbd "C-c n") 'cleanup-buffer)

     (global-set-key (kbd "M-j")
                  (lambda ()
                    (interactive)
                    (join-line -1)))

     (require 'recentf)
     (setq recentf-save-file "~/.emacs.d/.recentf"
           recentf-max-saved-items 200)
     (recentf-mode +1)

     ;; Enables paredit in the minibuffer when it is used to eval a lisp
     ;; expression with M-:
     (defun conditionally-enable-paredit-mode ()
       "Enable `paredit-mode' in the minibuffer, during `eval-expression'."
       (if (eq this-command 'eval-expression)
           (paredit-mode 1)))

     (add-hook 'minibuffer-setup-hook 'conditionally-enable-paredit-mode)

     ;; treat CamelCase words as seperate words for eg. deletion
     (add-hook 'prog-mode-hook 'subword-mode)

     (setq whitespace-global-modes '(not org-mode))
     ;;(global-whitespace-mode)
     (setq show-trailing-whitespace t)

     (defun htop ()
       "Start htop in its own buffer."
       (interactive)
       (ansi-term "htop" "htop"))

     (defun mixer ()
       "Start alsamixer in its own buffer"
       (interactive)
       (ansi-term "alsamixer" "mixer"))
   #+end_src
** package.el
old ELPA package config for historical interest
#+begin_src emacs-lisp :tangle no
  (require 'package)
  (add-to-list 'package-archives
            '("melpa" . "http://melpa.milkbox.net/packages/") t)
  (add-to-list 'package-archives
            '("org" . "http://orgmode.org/elpa/") t)
  (add-to-list 'package-archives
            '("tromey" . "http://tromey.com/elpa/") t)
  (add-to-list 'package-archives
            '("gnu" . "http://elpa.gnu.org/packages/") t)
  (add-to-list 'package-archives
            '("marmalade" . "http://marmalade-repo.org/packages/") t)
  (package-initialize)

  (when (not package-archive-contents)
   (package-refresh-contents))

  (defvar my-packages '((cl-lib)
                     (bbdb
                      (progn
                        (setq bbdb-file "~/.emacs.d/bbdb")
                        (require 'bbdb)
                        (bbdb-initialize 'gnus 'message)
                        (bbdb-insinuate-message)
                        (add-hook 'gnus-startup-hook 'bbdb-insinuate-gnus)
                        (setq bbdb-send-mail-style 'gnus)
                        (setq bbdb-complete-name-full-completion t)
                        (setq bbdb-completion-type 'primary-or-name)
                        (setq bbdb-complete-name-allow-cycling t)
                        (setq bbdb-offer-save 1
                              bbdb-use-pop-up t
                              bbdb-electric-p t
                              bbdb-popup-target-lines  1)))
                     ;;(bbdb-vcard)
                     (emms)
                     (deft
                       (progn
                         ;; deft: homepage: http://jblevins.org/projects/deft/
                         ;; also http://www.emacswiki.org/emacs/DeftMode
                         (setq deft-extension "org")
                         (setq deft-text-mode 'org-mode)
                         (setq deft-directory "~/Dropbox/notes")
                         (global-set-key [f8] 'deft) ; (setq deft-use-filename-as-title t)
                         ))
                     (evil)
                     (linum-off
                      (require 'linum-off))          ; linum slows down org-mode
                     (quack)
                     (geiser)
                     (puppet-mode)
                     (bitlbee (require 'bitlbee))
                     (rainbow-delimiters (add-hook 'prog-mode-hook 'rainbow-delimiters-mode))
                     (powerline)
                     (htmlize)                       ; required by org-mode html export
                     (helm-ag)
                     (w3m)
                     (elixir-mode)
                     (flymake-easy)                  ; required by flymake-elixir
                     (flymake-elixir
                      (progn
                        (add-hook 'find-file-hook 'flymake-find-file-hook)
                        (require 'flymake-elixir)
                        (add-hook 'elixir-mode-hook 'flymake-elixir-load)))
                     (smart-tab                      ; indents or completes, inteligently
                      (progn
                        (require 'smart-tab)
                        (global-smart-tab-mode 1)
                        (define-key read-expression-map [(tab)] 'hippie-expand)))
                     (nrepl                          ;  see https://github.com/kingtim/nrepl.el
                      (progn
                        (add-hook 'nrepl-interaction-mode-hook 'nrepl-turn-on-eldoc-mode)
                        (setq nrepl-hide-special-buffers t)
                        (add-to-list 'same-window-buffer-names "*nrepl*")
                        (add-hook 'nrepl-mode-hook 'subword-mode)
                        (add-hook 'nrepl-mode-hook 'paredit-mode)
                        (add-hook 'nrepl-mode-hook 'rainbow-delimiters-mode)))
                     (auctex)
                     (auctex-latexmk)
                     (ioccur)                       ; not sure if i like better than helm-occur or not
                     (switch-window)
                     (goto-last-change)
                     (org-page))
  "A list of packages to ensure are installed at launch.")

  (dolist (p my-packages)
   (progn
     (when (not (package-installed-p (car p)))
       (package-install (car p)))
     (eval (cadr p))))

  (custom-set-faces
  '(mode-line ((t (:foreground "#030303" :background "#bdbdbd" :box nil))))
  '(mode-line-inactive ((t (:foreground "#f9f9f9" :background "#666666" :box nil)))))
#+end_src
   :PROPERTIES:
   :CREATED:  [2014-07-01 Tue 14:21]
   :END:
** ido.el
   old ido config for historical reference
   #+begin_src emacs-lisp :tangle no
     use ido for minibuffer completion
     (require 'ido)
     (ido-mode t)
     (setq ido-save-directory-list-file "~/.emacs.d/.ido.last")
     (setq ido-enable-flex-matching t)
     (setq ido-use-filename-at-point 'guess)
     (setq ido-show-dot-for-dired t)

     smex: a better (ido like) M-x
     (setq smex-save-file "~/.emacs.d/.smex-items")
     (global-set-key (kbd "M-x") 'smex)
     (global-set-key (kbd "M-X") 'smex-major-mode-commands)
     (global-set-key (kbd "C-c C-c M-x") 'execute-extended-command) ; This is your old M-x.

     (require 'ido-ubiquitous)
     (ido-ubiquitous-mode 1)

     Fix ido-ubiquitous for newer packages
     (defmacro ido-ubiquitous-use-new-completing-read (cmd package)
      `(eval-after-load ,package
         '(defadvice ,cmd (around ido-ubiquitous-new activate)
          (let ((ido-ubiquitous-enable-compatibility nil))
            ad-do-it))))

     (ido-ubiquitous-use-new-completing-read webjump 'webjump)
     (ido-ubiquitous-use-new-completing-read yas/expand 'yasnippet)
     (ido-ubiquitous-use-new-completing-read yas/visit-snippet-file 'yasnippet)


     (defun recentf-ido-find-file ()
      "Find a recent file using ido."
      (interactive)
      (let ((file (ido-completing-read "Choose recent file: " recentf-list nil t)))
        (when file
          (find-file file))))
     (global-set-key (kbd "C-c f")  'recentf-ido-find-file)

     See the following
     org-refiling - http://kangtu.me/~kangtu/pavilion.html
     Targets include this file and any file contributing to the agenda - up to 9 levels deep
     See also http://doc.norang.ca/org-mode.html#RefileSetup
     Use IDO for both buffer and file completion and ido-everywhere to t
     (setq org-completion-use-ido nil)
     (setq ido-max-directory-size 100000)
     (ido-mode (quote both))

     (load-file "/usr/share/emacs/24.3/lisp/ido.el.gz")
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-07-01 Tue 14:30]
   :END:
* Programming
  :PROPERTIES:
  :CREATED:  [2014-10-07 Tue 13:24]
  :END:
** Quicklisp
   Added manually as per quicklisp instructed after running ~(ql:quickload "quicklisp-slime-helper")~ in sbcl
   #+begin_src emacs-lisp
     (load (expand-file-name "~/quicklisp/slime-helper.el"))
     (setq inferior-lisp-program "sbcl")
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-07-01 Tue 14:35]
   :END:
** paredit-mode
   #+begin_src emacs-lisp
     (prelude-require-package 'paredit)
     (add-hook 'lisp-interaction-mode-hook 'paredit-mode)
     (add-hook 'clojure-mode-hook 'paredit-mode)
     (add-hook 'emacs-lisp-mode-hook 'paredit-mode)
   #+end_src
** K / Kona
   #+begin_src emacs-lisp
     (add-to-list 'load-path "~/.local/opt/kona/src")
     (require 'k-mode)
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-08-18 Mon 14:05]
   :END:
** Rust
   #+begin_src emacs-lisp
    (prelude-require-packages '(rust-mode flycheck-rust))
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-10-09 Thu 23:42]
   :END:
** Picolisp
   #+begin_src emacs-lisp
     (setq picolisp-program-name "~/.local/opt/picolisp/pil +")
     (add-to-list 'load-path "~/.local/opt/picolisp/lib/el")
     (load "tsm.el") ;; Picolisp TransientSymbolsMarkup (*Tsm)
     (autoload 'run-picolisp "inferior-picolisp")
     (autoload 'picolisp-mode "picolisp" "Major mode for editing Picolisp." t)

     (add-to-list 'auto-mode-alist '("\\.l$" . picolisp-mode))

     (add-hook 'picolisp-mode-hook
               (lambda ()
                 (paredit-mode +1) ;; Loads paredit mode automatically
                 (tsm-mode) ;; Enables TSM
                 (define-key picolisp-mode-map (kbd "RET") 'newline-and-indent)
                 (define-key picolisp-mode-map (kbd "C-h") 'paredit-backward-delete)))
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-10-28 Tue 17:16]
   :END:
** lfe
#+begin_src emacs-lisp
  (prelude-require-package 'lfe-mode)
#+end_src
  :PROPERTIES:
  :CREATED:  [2014-11-21 Fri 17:28]
  :END:


* Org Mode
  :PROPERTIES:
  :CREATED:  [2014-10-07 Tue 13:37]
  :END:
** [[http://www.emacswiki.org/emacs/download/org-occur-goto.el][org-occur-goto]]
   #+begin_src emacs-lisp
     ;;; org-occur-goto.el -- search open org buffers with an occur interface

     ;; This file is free software; you can redistribute it and/or modify
     ;; it under the terms of the GNU General Public License as published by
     ;; the Free Software Foundation; either version 2, or (at your option)
     ;; any later version.

     ;; This file is distributed in the hope that it will be useful,
     ;; but WITHOUT ANY WARRANTY; without even the implied warranty of
     ;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     ;; GNU General Public License for more details.

     ;; You should have received a copy of the GNU General Public License
     ;; along with GNU Emacs; see the file COPYING.  If not, write to the
     ;; Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
     ;; Boston, MA 02110-1301, USA.

     ;;; Commentary:
     ;;;
     ;;;
     ;;; Usage: M-x oog, then start typing
     ;;;
     ;;; select from the occur matches with up/down/pgup/pgdown and press enter
     ;;; (you can navigate the history with M-p/M-n)
     ;;;
     ;;; the search string must be at least 3 characters long (by default)
     ;;;


     (require 'cl)

     (defvar oog-idle-delay 0.5)

     (defvar oog-minimum-input-length 3)


     (defvar oog-map
       (let ((map (copy-keymap minibuffer-local-map)))
         (define-key map (kbd "<down>") 'oog-next-line)
         (define-key map (kbd "<up>") 'oog-previous-line)
         (define-key map (kbd "<prior>") 'oog-previous-page)
         (define-key map (kbd "<next>") 'oog-next-page)
         map))



     (defvar oog-history-list nil)


     (defun oog-previous-line ()
       (interactive)
       (oog-move-selection 'forward-line -1))


     (defun oog-next-line ()
       (interactive)
       (oog-move-selection 'forward-line 1))


     (defun oog-previous-page ()
       (interactive)
       (oog-move-selection 'scroll-down nil))


     (defun oog-next-page ()
       (interactive)
       (oog-move-selection 'scroll-up nil))


     (defun oog-move-selection (movefunc movearg)
       (let ((win (get-buffer-window "*Occur*")))
         (if win
             (with-selected-window win
               (condition-case nil
                   (funcall movefunc movearg)
                 (beginning-of-buffer (goto-char (point-min)))
                 (end-of-buffer (goto-char (point-max))))))))


     (defun oog-check-input ()
       (when (sit-for oog-idle-delay)
         (unless (equal (minibuffer-contents) oog-current-input)
           (setq oog-current-input (minibuffer-contents))

           (if (< (length oog-current-input) oog-minimum-input-length)
               (let ((win (get-buffer-window "*Occur*")))
                 (if win
                     (with-selected-window win
                       (setq buffer-read-only nil)
                       (erase-buffer))))

             (save-excursion
               (flet ((message (&rest args) nil))  ;; suppress occur messages
                 (multi-occur
                  (remove nil (mapcar (lambda (buffer)
                                        (with-current-buffer buffer
                                          (if (eq major-mode 'org-mode)
                                              buffer)))
                                      (buffer-list)))
                  oog-current-input))
               (if (get-buffer "*Occur*")
                   ;; put cursor on first matching line for convenience
                   (let ((win (get-buffer-window "*Occur*")))
                     (if win
                         (with-selected-window win
                           (forward-line))))
                 (message "No matches.")))))))



     (defun oog ()
       (interactive)
       (let ((cursor-in-non-selected-windows 'box)
             marker)
         (save-window-excursion
           (add-hook 'post-command-hook 'oog-check-input)
           (setq oog-current-input nil)

           (unwind-protect
               (let ((minibuffer-local-map oog-map))
                 (read-string "string: " nil 'oog-history-list))

             (remove-hook 'post-command-hook 'oog-check-input))

           (let ((buf (get-buffer "*Occur*")))
             (if buf
                 (with-current-buffer buf
                   (unless (= (buffer-size) 0)
                     (setq marker (occur-mode-find-occurrence)))))))

         (switch-to-buffer (marker-buffer marker))
         (goto-char marker)
         (when (outline-invisible-p)
           (save-excursion
             (outline-previous-visible-heading 1)
             (org-show-subtree)))))
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-07-01 Tue 14:27]
   :END:
** org-page (no longer used)
   #+begin_src emacs-lisp :tangle no
     (require 'org-page)
   #+end_src
** TODO org-mode
   My personal org-mode config.
   TODO: was naively copied into my prelude config, check for redundancy
*** Load org-mode
    Loads my locally installed org-mode
    #+begin_src emacs-lisp
      ;; TODO: org-mobile-sync requires unavailable package emacs 24.3.50
      (prelude-require-packages '(org-pomodoro org-trello))
      (add-to-list 'load-path "~/.local/share/emacs/site-lisp/org")
      (add-to-list 'load-path "~/.emacs.d/org-mode/contrib/lisp")
      (load-file "~/.local/share/emacs/site-lisp/org/org-compat.el")
      (load-file "~/.local/share/emacs/site-lisp/org/org-list.el")
      (require 'org)
      (org-reload)
    #+end_src
*** org-toodledo
    #+begin_src emacs-lisp
      ;; org-toodledo is installed via git
      (add-to-list 'load-path (expand-file-name "org-toodledo" prelude-vendor-dir))
      (prelude-require-package 'http-post-simple)
      (require 'org-toodledo)
      (setq org-toodledo-preserve-drawers t)
      (setq org-toodledo-sync-new-completed-tasks t)
      (setq org-toodledo-userid "td52fa891b12039")
      (setq org-toodledo-status-to-org-map
            '(("Active" . "TODO")
              ("None" . "TODO")
              ("Next Action" . "NEXT")
              ("Planning" . "TODO")
              ("Delegated" . "DELEGATED")
              ("Waiting" . "WAITING")
              ("Someday" . "SOMEDAY")
              ("Hold" . "SOMEDAY")
              ("Postponed" . "SOMEDAY")
              ("Canceled" . "CANCELED")
              ("Reference" . "REFERENCE")))
    #+end_src
*** org-page
    #+begin_src emacs-lisp
      (setq
       op/personal-disqus-shortname "rfnash"
       op/personal-github-link "https://github.com/rfnash"
       op/repository-directory "~/git/blog.git/"
       op/repository-html-branch "gh-pages"
       op/repository-org-branch "source"
       op/site-domain "http://robertnash.net/"
       op/site-main-title "Robert Nash's Blog"
       op/site-sub-title "A sedomly updated blog")
    #+end_src
*** Various org settings
    #+begin_src emacs-lisp
      (setq
       org-log-into-drawer t
       org-refile-use-cache t
       org-return-follows-link t
       org-sort-agenda-notime-is-late nil
       org-agenda-skip-deadline-if-done t
       org-agenda-skip-scheduled-if-deadline-is-shown nil
       org-agenda-sorting-strategy (quote ((agenda time-up habit-down priority-down) (todo priority-down category-keep) (tags priority-down category-keep) (search category-keep)))
       org-journal-dir "~/Documents/OrgMode/journal/"
       org-directory "~/Documents/OrgMode"
       org-default-notes-file (concat org-directory "/notes.org")
       ;; org-mobile-use-encryption t
       org-mobile-directory "~/Dropbox/MobileOrg"
       org-mobile-inbox-for-pull (concat org-directory "from-mobile.org")
       org-habit-graph-column 65
       org-agenda-files (list     ; Can be set using C-c [ and C-c ] in org-mode
                         (concat org-directory "/notes.org")
                         (concat org-directory "/busybox.org")
                         (concat org-directory "/plover.org")
                         (concat org-directory "/Toodledo.org")
                         (concat org-directory "/reference.org")
                         (concat org-directory "/entertainment.org")
                         (concat org-directory "/filing.org")
                         (concat org-directory "/agenda.org")
                         (concat prelude-personal-dir "/rfnash/personal.org")
                         )
       org-agenda-custom-commands '(("n" "Agenda and all NEXT actions"
                                     ((agenda "")
                                      (tags-todo "NEXT|TODO=\"NEXT\"" nil)))
                                    ("v" "Videos to watch"
                                     tags "CATEGORY=\"ToWatch\"" nil)
                                    ;; TODO: consider only including those not under the appropriate level 1 heading
                                    ("f" "Bookmarks to file"
                                     ((todo "FILE"))))
       org-agenda-dim-blocked-tasks 'invisible
       org-agenda-skip-scheduled-if-deadline-is-shown t
       org-agenda-skip-scheduled-if-done t
       org-agenda-span 'day
       org-refile-use-cache t
       org-return-follows-link t
       org-sort-agenda-notime-is-late nil
       org-agenda-time-grid '((daily today require-timed)
                              #("----------------" 0 16
                                (org-heading t))
                              (800 900 1000 1200 1400 1600 1800 2000 2200 2259 2300))
       org-agenda-sorting-strategy '((agenda time-up habit-down priority-down category-keep)
                                     (todo priority-down category-keep)
                                     (tags priority-down category-keep)
                                     (search category-keep))
       org-enforce-todo-dependencies t
       org-blank-before-new-entry '((heading) (plain-list-item))
       org-contacts-birthday-format "Birthday: %h (%Y)"
       ;; org-drill-optimal-factor-matrix nil
       org-expiry-inactive-timestamps t
       ;; I had this set at 5, but setting Emac's timezone off by a few hours works better in practice,
       ;; because using this method, the completion day of habits is still recorded as when I actually did them,
       ;; not yesterday at 23:59
       org-extend-today-until 0
       org-habit-following-days 1
       org-habit-graph-column 64
       org-habit-preceding-days 14
       org-habit-show-all-today nil
       org-habit-show-done-always-green t
       org-id-link-to-org-use-id 'create-if-interactive-and-no-custom-id
       org-velocity-bucket "~/Documents/OrgMode/reference.org"
       )
    #+end_src
*** org-capture-templates
    #+begin_src emacs-lisp
      (setq
       org-capture-templates'(
                              ("a" "Article"
                               entry (id "1c5d07ad-8ba3-4db9-b3ae-3f4441cf51ca")
                               "* TODO %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("b" "Bookmarks to file"
                               entry ( id "3693c528-9bfb-43c4-91e3-d68550fc4799" )
                               "* FILE %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("B" "Bookmarks to file (with link annotation)"
                               entry ( id "3693c528-9bfb-43c4-91e3-d68550fc4799" )
                               "* FILE %?%a\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("H" "Scheduled Task"
                               entry ( id "79c8de14-8039-4d8c-b87e-f8c499860694")
                               "* SCHED %?\nSCHEDULED: %t")
                              ("d" "Design Examples"
                               entry (id  "756f3a10-f323-409b-b418-00074ba93de9")
                               "* %? :GoodDesign:\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("h" "Habbit"
                               entry ( id "b8e8b020-2772-4028-b209-1a52d3cb2fe6")
                               "* HABIT %?\n:PROPERTIES:\n:STYLE: habit\n:END:")
                              ("j" "Datetree entry"
                               entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                               "* %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("J" "Clocked entry"
                               entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                               "* %?\n%U"
                               :clock-in t
                               :clock-keep t)
                              ("k" "Book to read"
                               entry ( id "31b8afb4-8d11-4334-a12a-5f4490a77f3a")
                               "* SOMEDAY %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("m" "Good Song"
                               table-line (id "b3a14888-312d-432e-8062-4ed352866729")
                               " | %^{Title} | %^{Artist} |"
                               :immediate-finish t)
                              ;; ("n" "Task - Next"
                              ;;  entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                              ;;  "* NEXT %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("N" "Non-profit"
                               entry ( id "9e1cc358-cbc6-4b72-af68-c16017986720")
                               "* %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("o" "Toodledo Task"
                               entry ( id "bbd1b4a1-3f1a-4e97-ac45-7719edbaf700")
                               "* NEXT %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("p" "Person"
                               entry ( id "fbefa010-a0a4-4915-bc7e-ce1844a5e3a5")
                               "* %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("P" "Personal"
                               entry ( id "5baf8be5-b956-421a-950c-6e39c8e6d52e")
                               "* %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("s" "Scratch"
                               entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                               "* %? :SCRATCH:\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("S" "Sent to Kindle"
                               entry ( id "baef29b1-40b5-4704-bf28-24b1898c41c9")
                               "* TODO %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("t" "Task"
                               entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                               "* TODO %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("T" "Task (with link annotation)"
                               entry ( file+datetree "~/Documents/OrgMode/agenda.org")
                               "* TODO %?%a\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("u" "Quote"
                               entry (id "67e35685-d8e5-488d-8ab2-ac36a7ee3c9a")
                               "* %?\n:PROPERTIES:\n:CREATED:  %U\n:END:")
                              ("w" "To Watch"
                               entry ( id "e8e91a3d-d21b-403d-b46e-0be14a3d7c2d")
                               "* TODO %?\n:PROPERTIES:\n:CREATED:  %U\n:END:"))
       ;; org-capture-templates (("c" "Jac" entry (file+datetree "~/cjr/jac/jac.org")
       ;; "* %^{Title}  :blog:
       ;;  :PROPERTIES:
       ;;  :on: %T
       ;;  :END:
       ;;  %?
       ;;  %x"))
       )

    #+end_src
*** org related global keybindings
    #+begin_src emacs-lisp
      (global-set-key "\C-cl" 'org-store-link)
      (global-set-key "\C-cc" 'org-capture)
      (global-set-key "\C-ca" 'org-agenda)
      (global-set-key "\C-cb" 'org-iswitchb)
      (global-set-key (kbd "C-c v") 'org-velocity-read)
      (global-set-key (kbd "C-c F") 'oog)
    #+end_src
*** org-publish
    #+begin_src emacs-lisp
      (setq org-publish-project-alist
            '(
              ("org-contents"
               :base-directory "~/org/"
               :base-extension "org"
               :publishing-directory "~/public_html/org-site/"
               :recursive t
               :publishing-function org-publish-org-to-html
               :table-of-contents nil
               :section-numbers nil
               ;;:author nil
               ;;:creator-info nil
               :html-postamble nil
               :auto-sitemap t
               )
              ("org" :components ("org-contents"))))
    #+end_src
*** org refiling
    #+begin_src emacs-lisp
      ;; org-refiling - http://kangtu.me/~kangtu/pavilion.html
      ;; Targets include this file
      ;; and any file contributing to the agenda - up to 9 levels deep
      ;; See also http://doc.norang.ca/org-mode.html#RefileSetup
      (setq org-refile-targets (quote ((nil :maxlevel . 9)
                                       (org-agenda-files :maxlevel . 9))))
      ;; Use full outline paths for refile targets - we file directly with IDO
      (setq org-refile-use-outline-path t)

      ;; Targets complete directly with IDO / Helm
      (setq org-outline-path-complete-in-steps nil)

      ;; Allow refile to create parent tasks with confirmation
      (setq org-refile-allow-creating-parent-nodes (quote confirm))
    #+end_src
*** org-expiry
    #+begin_src emacs-lisp
      (require 'org-expiry)
      (org-expiry-insinuate)
    #+end_src
*** Reminders
    From http://doc.norang.ca/org-mode.html#Reminders
    Set up reminders for all upcoming appointments
    #+begin_src emacs-lisp
    ;; (defun bh/org-agenda-to-appt ()
    ;;   "Erase all reminders and rebuilt reminders for today from the agenda."
    ;;   (interactive)
    ;;   (setq appt-time-msg-list nil)
    ;;   (org-agenda-to-appt))

    ;; ;; Rebuild the reminders everytime the agenda is displayed
    ;; (add-hook 'org-finalize-agenda-hook 'bh/org-agenda-to-appt 'append)

    ;; ;; This is at the end of my .emacs - so appointments are set up when Emacs starts
    ;; (bh/org-agenda-to-appt)

    ;; ;; Activate appointments so we get notifications
    ;; (appt-activate t)

    ;; ;; If we leave Emacs running overnight - reset the appointments one minute after midnight
    ;; (run-at-time "24:01" nil 'bh/org-agenda-to-appt)
    #+end_src
*** TODO org-protocol help
    These don't seem to be working for me.
    I want something that will only close the frame if it was created by org-protocol
    #+begin_src emacs-lisp
      (defadvice org-capture-finalize
          (after delete-capture-frame activate)
        "Advise capture-finalize to close the frame."
        (if (equal "capture" (frame-parameter nil 'name))
            (delete-frame)))

      (defadvice org-capture-kill
          (after delete-capture-frame activate)
        "Advise capture-kill to close the frame."
        (if (equal "capture" (frame-parameter nil 'name))
            (delete-frame)))
    #+end_src
*** Hide blocked tasks
    #+begin_src emacs-lisp :tangle no
      (defvar rfnash-hide-blocked-tasks nil "If non-nil, hide blocked tasks, else dim them.")
      (defun org-agenda-hide-blocked-tasks ()
        "Toggle dimming/hiding blocked tasks."
        (interactive)
        (if rfnash-hide-blocked-tasks
            (progn
              (setq rfnash-hide-blocked-tasks nil)
              (org-agenda-dim-blocked-tasks)
              )
          (progn
            (setq rfnash-hide-blocked-tasks t)
            (org-agenda-dim-blocked-tasks t))))
      (define-key org-agenda-mode-map (kbd "#") 'org-agenda-hide-blocked-tasks)
    #+end_src
    :PROPERTIES:
   :CREATED:  [2014-09-03 Wed 16:42]
   :END:
** org-modules
   Require all of the org-mode modules that I use.
   #+begin_src emacs-lisp
     ;; http://orgmode.org/worg/org-contrib/
     (require 'org-agenda)                      ; add (load-library "org-compat")
     (require 'org-annotate-file)
     (require 'org-bbdb)
     (require 'org-bibtex)                      ; export bibtex fragments(require '
     (require 'org-bookmark)
     (require 'org-capture)
     (require 'org-checklist)
     (require 'org-choose)                      ; http://orgmode.org/worg/org-contrib/org-choose.html
     (require 'org-collector)                   ; http://orgmode.org/worg/org-contrib/org-collector.html
     (require 'org-contacts)
     (require 'org-ctags)
     ;; (require org-depend)                    ; http://orgmode.org/worg/org-contrib/org-depend.html
     (require 'org-drill)
     (require 'org-elisp-symbol)
     (require 'org-eshell)
     (require 'org-eval)
     (require 'org-eval-light)
     (require 'org-expiry)
     (require 'org-git-link)
     (require 'org-gnus)
     (require 'org-habit)
     (require 'org-id)
     ;; (require org-index)                     ; http://orgmode.org/worg/org-contrib/org-index.html
     (require 'org-info)
     (require 'org-inlinetask)
     ;;(require 'org-json)
     (require 'org-learn)
     (require 'org-man)
     (require 'org-mobile)
     (require 'org-mouse)
     ;;(require 'org-mtags)
     ;; (require org-occur-goto)                ; http://www.emacswiki.org/emacs/org-search-goto.el
     ;;(require 'org-panal)
     (require 'org-protocol)
     (require 'org-registry)
     ;; (require org-search-goto)               ; http://www.emacswiki.org/emacs/org-search-goto.el
     ;;(require org-search-goto-ml)               ;  http://www.emacswiki.org/emacs/org-search-goto-ml.el
     (require 'org-secretary)                   ; http://juanreyero.com/article/emacs/org-teams.html
     (require 'org-toc)
     (require 'org-track)                       ; http://orgmode.org/worg/org-contrib/org-track.html
     (require 'org-velocity)                    ; http://orgmode.org/worg/org-contrib/org-velocity.html
     (require 'org-w3m)
     (require 'remember)
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-09-03 Wed 16:42]
   :END:
** TODO OrgBox
   Just trying it out.
   #+begin_src emacs-lisp
     (prelude-require-package 'orgbox)
     (require 'orgbox)
   #+end_src
   :PROPERTIES:
   :CREATED:  [2014-10-22 Wed 22:31]
   :END:
* Load [[http://batsov.com/prelude/][Emacs Prelude]] modules
  #+begin_src emacs-lisp
    ;;; Uncomment the modules you'd like to use and restart Prelude afterwards
    (require 'prelude-erc)                  ; Emacs IRC client
    (require 'prelude-ido)                  ; Super charges Emacs completion for C-x C-f and more
    (require 'prelude-helm)                 ; Interface for narrowing and search
    (require 'prelude-company)
    (require 'prelude-key-chord)            ; Binds useful features to key combinations
    (require 'prelude-mediawiki)
    ;;(require 'prelude-evil')                ; what about evil-org and evil-paredit?

    ;;; Programming languages support
    (require 'prelude-c)
    (require 'prelude-clojure)
    (require 'prelude-coffee)
    (require 'prelude-common-lisp)
    (require 'prelude-css)
    (require 'prelude-emacs-lisp)
    (require 'prelude-erlang)
    (require 'prelude-haskell)
    (require 'prelude-js)
    (require 'prelude-latex)
    (require 'prelude-lisp)
    (require 'prelude-org)                  ; Org-mode helps you keep TODO lists, notes and more
    (require 'prelude-perl)
    (require 'prelude-python)
    (require 'prelude-ruby)
    (require 'prelude-scala)
    (require 'prelude-scheme)
    (require 'prelude-shell)
    (require 'prelude-scss)
    (require 'prelude-web)                  ; Emacs mode for web templates
    (require 'prelude-xml)
  #+end_src
* Set the default directory to HOME
  #+begin_src emacs-lisp
    (setq default-directory "~")
  #+end_src
* smart-tab and hippie-expand
  #+begin_src emacs-lisp
    (prelude-require-package 'smart-tab)
    (require 'smart-tab)
    (global-smart-tab-mode 1)
    (define-key read-expression-map [(tab)] 'hippie-expand)
  #+end_src
* elscreen
  #+begin_src emacs-lisp
    (prelude-require-package 'elscreen)
  #+end_src
* switch-window
  #+begin_src emacs-lisp
    (prelude-require-package 'switch-window)
    (global-set-key (kbd "C-x o") 'switch-window)
  #+end_src
* emagician-fix-spell-memory
  #+begin_src emacs-lisp
  (prelude-require-package 'emagician-fix-spell-memory)
  (require 'emagician-fix-spell-memory)
  #+end_src
* elip
  #+begin_src emacs-lisp :tangle no
    (add-to-list 'load-path "~/.local/share/emacs/site-lisp")
    (add-to-list 'load-path "~/.local/share/emacs/site-lisp/edb")
    (require 'elip)
  #+end_src
* Require various packages
  #+begin_src emacs-lisp
    (prelude-require-packages '(helm-orgcard helm-descbinds helm-backup helm-helm-commands))
    (prelude-require-packages '(ag helm-ag helm-ag-r))
    (prelude-require-packages '(caskxy graphviz-dot-mode))
    (prelude-require-package 'elnode)
  #+end_src
* Volume
  #+begin_src emacs-lisp
    (prelude-require-package 'volume)
    (setq volume-backend 'volume-amixer-backend)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-11-12 Wed 19:21]
  :END:
* Yasnippet
  #+begin_src emacs-lisp
    (prelude-require-packages '(yasnippet helm-c-yasnippet))
    (yas-global-mode 1)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-11-12 Wed 19:35]
  :END:
* calfw
      #+begin_src emacs-lisp
        (prelude-require-packages '(calfw calfw-gcal))

        (require 'calfw-gcal)
        (require 'calfw-org)

        (defun my-open-calendar ()
          (interactive)
          (cfw:open-calendar-buffer
           :contents-sources
           (list
            (cfw:org-create-source "Green")  ; orgmode source
            )))
  #+end_src
* BBDB
  #+begin_src emacs-lisp
    (prelude-require-package 'bbdb)
    (setq bbdb-file "~/.emacs.d/bbdb")
    (require 'bbdb)
    (bbdb-initialize 'gnus 'message)
    (bbdb-insinuate-message)
    (add-hook 'gnus-startup-hook 'bbdb-insinuate-gnus)
    (add-hook 'kill-emacs-hook 'bbdb-save)
    ;;(prelude-require-package 'bbdb-vcard)
  #+end_src
* helm-mu
  #+begin_src emacs-lisp
    (add-to-list 'load-path (expand-file-name "helm-mu" prelude-vendor-dir))
    ;;(require 'helm-mu)
  #+end_src
* eclectic pair mode
  #+begin_src emacs-lisp
    (electric-pair-mode +1)
    (electric-indent-mode +1)
  #+end_src
* [[https://github.com/swannodette/ob-sml][ob-sml]]
  #+begin_src emacs-lisp
    (prelude-require-package 'ob-sml)
  #+end_src
* paradox
  #+begin_src emacs-lisp
    (prelude-require-package 'paradox)
  #+end_src
* EWW
  #+begin_src emacs-lisp
    (prelude-require-package 'eww-lnum)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-10-29 Wed 18:37]
  :END:
* Default browser
  Set the default browser to vimb.
  #+begin_src emacs-lisp
    (setq browse-url-browser-function
          'browse-url-generic browse-url-generic-program "firefox")
  #+end_src
* TODO set-browser
  A function to easily interactively change the default browser.
  TODO: include a list of browsers to choose from.
  #+begin_src emacs-lisp
    (defun set-browser (browser)
      "Prompt for BROWSER to set as default."
      (interactive "sBrowser: ")
      (setq browse-url-browser-function
            'browse-url-generic browse-url-generic-program browser))
  #+end_src
* babel
  #+begin_src emacs-lisp
    (prelude-require-package 'babel)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-07-24 Thu 10:09]
  :END:
* ledger-mode
  #+begin_src emacs-lisp
    (prelude-require-package 'ledger-mode)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-07-24 Thu 10:09]
  :END:
* nix-mode
  #+begin_src emacs-lisp
    (prelude-require-package 'nix-mode)
    (require 'nix-mode)
  #+end_src
* Color Theme
  My settings to use the solarized light color theme.
  #+begin_src emacs-lisp
    ;; Set up the old-fashioned Solarized color theme
    ;; and set ansi-term to use solarized dark colors

    ;; Could be a coincidence, but since adding Solarized,
    ;; but I can't get 'Emacs --daemon' to work

    (prelude-require-packages '(solarized-theme load-theme-buffer-local color-theme color-theme-buffer-local color-theme-solarized))

    (setq light t)           ; setting to t works and remove undefined var error
    ;;(load-theme 'solarized-light t)
    ;;(if (display-graphic-p)
    ;;    (load-theme 'solarized-light t)
    ;;  (load-theme 'solarized-dark t))

    (disable-theme 'zenburn)
    (require 'color-theme)
    (color-theme-solarized-light)

    (set-face-attribute 'default nil :family "Liberation Mono for Powerline" :height 120)

    ;;; ansi-term solarized settings

    (require 'term)
    (setq term-mode-hook '((lambda nil
                             ;; To use new deftheme instead of color-theme
                             ;;                         (load-theme-buffer-local
                             ;;                         'solarized-dark
                             ;;                          (current-buffer)
                             ;;                          t)))

                             ;; (color-theme-buffer-local
                             ;;  (quote color-theme-solarized-dark)
                             ;;  (current-buffer))
                             (setq-local dark t)
                             (load-theme-buffer-local
                              'solarized-dark
                              (current-buffer) t nil)))
          term-scroll-to-bottom-on-output t)

    ;; TODO: is probably a bad idea to set this here. Find a better way.
    (custom-set-faces
     ;; custom-set-faces was added by Custom.
     ;; If you edit it by hand, you could mess it up, so be careful.
     ;; Your init file should contain only one such instance.
     ;; If there is more than one, they won't work right.
     '(term ((t (:inherit default :background "#002b36"))))
     '(term-bold ((t (:inverse-video t :weight bold))))
     '(term-color-black ((t (:background "#002b36" :foreground "#073642"))))
     '(term-color-blue ((t (:background "#002b36" :foreground "#268bd2"))))
     '(term-color-cyan ((t (:background "#002b36" :foreground "#2aa198"))))
     '(term-color-green ((t (:background "#002b36" :foreground "#859900"))))
     '(term-color-magenta ((t (:background "#002b36" :foreground "#d33682"))))
     '(term-color-red ((t (:background "#002b36" :foreground "#dc322f"))))
     '(term-color-white ((t (:background "#002b36" :foreground "#eee8d5"))))
     '(term-color-yellow ((t (:background "#002b36" :foreground "#b58900")))))
  #+end_src
  :PROPERTIES:
 :CREATED:  [2014-09-03 Wed 16:41]
 :END:
* El-get
  Install and configure various packages through el-get.
  #+begin_src emacs-lisp
    (add-to-list 'load-path "~/.emacs.d/el-get/el-get")

    (require 'el-get nil t)                       ; to appease flycheck
    (unless (require 'el-get nil t)
      (url-retrieve
       "https://github.com/dimitri/el-get/raw/master/el-get-install.el"
       (lambda (s)
         (end-of-buffer)
         (eval-print-last-sexp))))

    ;; now either el-get is `require'd already, or have been `load'ed by the
    ;; el-get installer.

    ;; set local recipes
    (setq
     el-get-sources
     '((:name el-get)          ; el-get is self-hosting
       (:name nxhtml)          ; for html emails and wrap-to-file-column-mode
       ;; (:name o-blog)       ; version in package.el doesn't work
       (:name pwsafe :after (setq pwsafe-primary-database "~/Dropbox/pwsafe.dat"))
       ;; (:name org-mode)
       (:name erc-extras)
       (:name erc-nick-notify)
       (:name emacs-http-server)
       (:name webkit)
       ;;(:name bbdb-vcard)
       ;; (:name bbdb (progn
       ;;                    (setq bbdb-file "~/.emacs.d/bbdb")
       ;;                    (require 'bbdb)
       ;;                    (bbdb-initialize 'gnus 'message)
       ;;                    (bbdb-insinuate-message)
       ;;                    (add-hook 'gnus-startup-hook 'bbdb-insinuate-gnus)
       ;;                     (add-hook 'kill-emacs-hook 'bbdb-save)))
       ))

    ;; Adds packages from local recipes above
    (setq my:el-get-packages
          (loop for src in el-get-sources collect (el-get-source-name src)))

    ;; install new packages and init already installed packages
    (el-get 'sync my:el-get-packages)

  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:41]
  :END:
* ERC
  My personal ERC config.
  From emacswiki.org/emacs/ERC.
  #+begin_src emacs-lisp
    ;; (setq erc-echo-notices-in-minibuffer-flag t)

    ;; (require 'erc-match)
    ;; (setq erc-keywords '("Niki" "Nikki"))

    ;; ;; Doesn't seem to work
    ;; (require 'notifications)
    ;; (defun erc-global-notify (match-type nick message)
    ;;   "Notify when a message is recieved."
    ;;   (notifications-notify
    ;;    :title nick
    ;;    :body message
    ;;    :urgency 'low))
    ;; (add-hook 'erc-text-matched-hook 'erc-global-notify)


    ;; ;; Creates new buffer each time someone pm's me
    ;; ;; opens second window and shows buffer in non-focused window
    ;; ;; This happens even on different screen in elscreen
    ;; (setq erc-auto-query 'buffer)
    ;; (add-hook 'erc-after-connect
    ;;        (lambda (server nick)
    ;;          (add-hook 'erc-server-NOTICE-hook 'erc-auto-query)))

    ;; ;; Doesn't seem to work
    ;; (setq erc-autojoin-channels-alist
    ;;       '(("***REMOVED***.com" "#lesbian" "#sub/Dom" "#sluts_craving_humiliation")))
    ;;      ;;("oftc.net" "#bitlbee")))

    (add-to-list 'load-path "~/.emacs.d/prelude/personal")
      (prelude-require-package 'znc)
    (require 'erc)
    ;;(require 'erc-nicklist)
    (setq znc-servers '(("localhost" 1666 t ((efnet "rfnash/efnet" "***REMOVED***")
                                             (freenode "rfnash/freenode" "***REMOVED***")
                                             (mozilla "rfnash/mozilla" "***REMOVED***")
                                             (bitlbee "rfnash/bitlbee" "***REMOVED***")))))
    (setq erc-nicklist-voiced-position 'top)

    (autoload 'erc-nick-notify-mode "erc-nick-notify"
      "Minor mode that calls `erc-nick-notify-cmd' when his nick gets
    mentioned in an erc channel" t)
    ;; (eval-after-load 'erc '(erc-nick-notify-mode t))
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:41]
  :END:
* mu4e
  My personal mu4e config.
  #+begin_src emacs-lisp
    (add-to-list 'load-path (expand-file-name "mu/mu4e" prelude-vendor-dir))
    (require 'mu4e)
    (setq mu4e-mu-binary "~/.local/bin/mu"   ;; use local version of mu
          mu4e-maildir       "~/Maildir"       ;; top-level Maildir
          mu4e-sent-folder   "/Sent"           ;; folder for sent messages
          mu4e-drafts-folder "/Drafts"         ;; unfinished messages
          mu4e-trash-folder  "/Trash"          ;; trashed messages
          mu4e-refile-folder "/archive"        ;; saved messages
          mu4e-get-mail-command "")
    (add-to-list 'mu4e-view-actions
                                            ; Open message in external browser with 'x' as the shortcut
                 '("xview in browser" . mu4e-action-view-in-browser) t)
    (add-hook 'mu4e-view-mode-hook 'wrap-to-fill-column-mode)

    (provide 'rfnash-mu4e)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:41]
  :END:
* newsticker
  #+begin_src emacs-lisp
    (require 'newsticker)
    (global-set-key (kbd "C-c r") 'newsticker-treeview)
    (setq newsticker-html-renderer 'w3m-region)
    '(newsticker-url-list
      (quote
       (("HMK's Spurious Thoughts" "http://www.spuriousthoughts.com/feed/atom/" nil nil nil)
        ("The Paleo Pair" "http://thepaleopair.tumblr.com/rss" nil nil nil)
        ("The NewsBlur Blog" "http://blog.newsblur.com/rss" nil nil nil)
        ("Tom Morris" "http://tommorris.org/posts.xml" nil nil nil)
        ("Less Wrong" "http://lesswrong.com/.rss" nil nil nil)
        ("A Life Less Bullshit" "http://feeds.feedburner.com/lifelessbullshit?format=xml" nil nil nil)
        ("Mostly Harmless" "http://robrhinehart.com/?feed=rss2" nil nil nil)
        ("Adam Prescott" "https://aprescott.com/feed" nil nil nil)
        ("Ben Werdmuller" "http://benwerd.com/feed/" nil nil nil)
        ("Comments on: Home" "http://www.alifeonyourterms.com/home/feed/" nil nil nil)
        ("The Pidgeonhole Principal" "http://joneisen.tumblr.com/rss" nil nil nil)
        ("Robert Heaton" "http://feeds.feedburner.com/RobertHeaton?format=xml" nil nil nil)
        ("Marco.org" "http://www.marco.org/rss" nil nil nil)
        ("Justin Vincent" "http://justinvincent.com/feed" nil nil nil)
        ("copyrighteous" "http://mako.cc/copyrighteous/feed" nil nil nil)
        ("SlashGeek" "http://www.slashgeek.net/feed/" nil nil nil)
        ("kyleisom.net" "http://www.kyleisom.net/feed.xml" nil nil nil)
        ("Emacs Redux" "http://emacsredux.com/atom.xml" nil nil nil)
        ("What the .emacs.d!?" "http://whattheemacsd.com/atom.xml" nil nil nil)
        ("Bapt" "http://blog.etoilebsd.net/index.atom" nil nil nil)
        ("Hile Household" "http://hilehousehold.squarespace.com/journal?format=rss" nil nil nil)
        ("Mostly Maths" "http://feeds.feedburner.com/MostlyMaths" nil nil nil)
        ("The Friendly Anarchist" "http://feeds.feedburner.com/FriendlyAnarchist" nil nil nil)
        ("plasticbag.org" "http://plasticbag.org/feed" nil nil nil)
        ("Mottr.am" "http://mottr.am/atom.xml" nil nil nil)
        ("Signal vs. Noise" "http://feeds.feedburner.com/37signals/beMH" nil nil nil)
        ("Andy Mangold on scriptogr.am" "http://feeds.feedburner.com/andymangold?format=xml" nil nil nil)
        ("The Buffer blog: productivity, life hacks, writing..." "http://feeds.feedburner.com/bufferapp" nil nil nil)
        ("Dustin Curtis" "http://feeds.feedburner.com/dcurtis" nil nil nil)
        ("Debu.gs" "http://feeds.feedburner.com/debugs" nil nil nil)
        ("Inside 206-105" "http://feeds.feedburner.com/ezyang" nil nil nil)
        ("Infotropism" "http://infotrope.net/feed/" nil nil nil)
        ("Startups, life, learning and happiness" "http://feeds.feedburner.com/joelis" nil nil nil)
        ("Tiny Buddha" "http://tinybuddha.com/feed/" nil nil nil)
        ("Raptitude.com" "http://feeds2.feedburner.com/Raptitudecom" nil nil nil)
        ("Tynan | Life Outside the Box" "http://feeds.feedburner.com/tynan?format=xml" nil nil nil)
        ("zenhabits" "http://zenhabits.net/feed/" nil nil nil)
        ("Lifehacker" "http://feeds.gawker.com/lifehacker/vip" nil nil nil)
        ("mnmlist" "http://mnmlist.com/feed/" nil nil nil)
        ("Nathan's Blog" "http://blog.nathantypanski.com/rss" nil nil nil)
        ("Lost in Technopolis" "http://newartisans.com/feed/" nil nil nil)
        ("Poly in Pictures" "http://www.polyinpictures.com/feed/" nil nil nil)
        ("Practically Efficient" "http://feeds.feedburner.com/PracticallyEfficient" nil nil nil)
        ("programming is terrible" "http://programmingisterrible.com/rss" nil nil nil)
        ("Rands In Repose" "http://www.randsinrepose.com/index.xml" nil nil nil)
        ("Blog" "http://paulwhile.squarespace.com/blog/rss.xml" nil nil nil)
        ("simple links" "http://zenhabits.tumblr.com/rss" nil nil nil)
        ("The Setup" "http://usesthis.com/feed/" nil nil nil)
        ("We Use That" "http://weusethat.com/rss.xml" nil nil nil)
        ("Under the Tamarind Tree" "https://underthetamarindtree.wordpress.com/feed/" nil nil nil)
        ("Falkvinge on Infopolicy" "http://feeds.falkvinge.net/Falkvinge-on-Infopolicy" nil nil nil)
        ("Matt Might's blog" "http://matt.might.net/articles/feed.rss" nil nil nil)
        ("Simplexify" "http://simplexify.net/blog/atom.xml" nil nil nil)
        ("SMYCK" "http://smyck.net/feed/" nil nil nil)
        ("The Pastry Box Project" "http://the-pastry-box-project.net/feed/" nil nil nil)
        ("skud" "http://skud.dreamwidth.org/data/atom" nil nil nil)
        ("One Thing Well" "http://onethingwell.org/rss" nil nil nil)
        ("jake levine" "http://jakelevine.me/blog/feed/" nil nil nil)
        ("Steve Losh" "http://feeds2.feedburner.com/stevelosh" nil nil nil)
        ("DAILY VIOLET" "http://violetblue.tumblr.com/rss" nil nil nil)
        ("violet blue  :: open source sex" "http://www.tinynibbles.com/feed" nil nil nil)
        ("This View of Life" "http://www.thisview.org/?feed=rss2" nil nil nil)
        ("Zack Shapiro" "http://zackshapiro.com/rss" nil nil nil)
        ("Zack Shapiro" "http://feeds.feedburner.com/zackshapiro/glGU" nil nil nil)
        ("Send More Paramedics" "http://blog.fogus.me/feed/" nil nil nil))))
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:41]
  :END:
* Helm
  My personal customization to helm.
  #+begin_src emacs-lisp
    (require 'helm)
    (require 'helm-config)

    ;; Doesn't override ido for find files, but does for C-h f, so perfect
    (helm-mode 1)

    ;; I prefer helm over smex
    (global-set-key (kbd "M-x") 'helm-M-x)

    ;; not sure if I really want to enable or not
    ;; (add-hook 'eshell-mode-hook
    ;;           #'(lambda ()
    ;;               (define-key eshell-mode-map
    ;;                 [remap eshell-pcomplete]
    ;;                 'helm-esh-pcomplete)))

    (global-set-key (kbd "C-x c o") 'helm-occur)

    ;; Doesn't play well with gnus
    ;;(setq helm-split-window-in-side-p t)


    ;; added (find-file . ido) as I prefer ido's find-file interface to helm's,
    ;; but prefer helm for everything else.
    (add-to-list 'helm-completing-read-handlers-alist '(find-file . ido))
    (add-to-list 'helm-completing-read-handlers-alist '(switch-to-buffer . ido))

    ;; Increased from 0.1 to 0.5 (the value used by org-occur-goto)
    ;; because of the long time it takes to search
    (setq helm-m-occur-idle-delay 0.5)

    (require 'ido)
    (setq ido-everywhere t)
    (setq ido-ignore-buffers helm-boring-buffer-regexp-list)
    (ido-mode 1)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:54]
  :END:
* prelude mode
  Emacs Prelude: minor mode.
  #+begin_src emacs-lisp
    ;; Based on http://emacsredux.com/blog/2013/03/29/terminal-at-your-fingertips/

    (require 'prelude-mode)

    (defun rfnash-switch-buffer (buffer)
      "Switch to BUFFER using elscreen if possible;
    if not, use 'switch-to-buffer-other-window'"
      (if (fboundp 'elscreen-find-and-goto-by-buffer)
          (elscreen-find-and-goto-by-buffer buffer t)
        (switch-to-buffer buffer)))

    (defun rfnash-visit-org-notes-buffer ()
      "Visit my notes.org buffer."
      (interactive)
      (if (get-buffer "notes.org")
          (rfnash-switch-buffer "notes.org")))

    (defun rfnash-visit-org-agenda-buffer ()
      "Create or visit 'org-mode' agenda buffer."
      (interactive)
      (if (get-buffer "*Org Agenda*")
          (rfnash-switch-buffer "*Org Agenda*")
        (org-agenda nil "n")))

    (defun rfnash-visit-term-buffer ()
      "Create or visit term buffer."
      (interactive)
      (if (get-buffer "*ansi-term*")
          (rfnash-switch-buffer "*ansi-term*")
        (ansi-term "tmux-attach")))

    (defun rfnash-visit-eshell-buffer ()
      "Create or visit an eshell buffer."
      (interactive)
      (if (get-buffer "*eshell*")
          (rfnash-switch-buffer "*eshell*")
        (eshell)))

    (defun rfnash-visit-gnus-buffer ()
      "Create or visit GNUS's group buffer."
      (interactive)
      (if (get-buffer "*Group*")
          (rfnash-switch-buffer "*Group*")
        (gnus)))

    (defun rfnash-visit-mu4e-buffer ()
      "Create or visit mu4e's main buffer."
      (interactive)
      (if (get-buffer "*mu4e-main*")
          (rfnash-switch-buffer "*mu4e-main*")
        (mu4e)))

    (defun rfnash-visit-scratch-buffer ()
      "Visit *scratch* buffer."
      (interactive)
      (if (get-buffer "*scratch*")
          (rfnash-switch-buffer "*scratch*")
        (if (fboundp 'elscreen-create)
            (elscreen-create)
          (progn
            (switch-to-buffer (get-buffer-create "*scratch*"))
            (lisp-interaction-mode)))))

    ;; From http://stackoverflow.com/a/1249665
    (defun my-horizontal-recenter ()
      "Make the point horizontally centered in the window."
      (interactive)
      (let ((mid (/ (window-width) 2))
            (line-len (save-excursion (end-of-line) (current-column)))
            (cur (current-column)))
        (if (< mid cur)
            (set-window-hscroll (selected-window)
                                (- cur mid)))))

    (defun rfnash-scroll-left-edge ()
      "Like `my-horizontal-recenter', but place point at the left edge of the window."
      (interactive)
      (set-window-hscroll (selected-window) (current-column)))

    (global-set-key (kbd "C-c x l") 'rfnash-scroll-left-edge)
    (global-set-key (kbd "C-S-L") 'rfnash-scroll-left-edge)

    (defun browse-weather ()
      "Look up the current weather on forecast.io."
      (interactive)
      (browse-url "http://forecast.io/"))

    (define-key prelude-mode-map (kbd "C-x F") 'browse-weather)

    (define-key prelude-mode-map (kbd "C-c i") 'prelude-ido-goto-symbol)
    (define-key prelude-mode-map (kbd "C-c o") (lambda () (interactive) (helm-multi-occur (org-buffer-list))))
    (define-key prelude-mode-map (kbd "C-c O") 'prelude-open-with)
    (define-key prelude-mode-map (kbd "C-c h") 'rfnash-visit-org-agenda-buffer)
    (define-key prelude-mode-map (kbd "C-c g") 'rfnash-visit-gnus-buffer)
    (define-key prelude-mode-map (kbd "C-c m") 'rfnash-visit-mu4e-buffer)
    (define-key prelude-mode-map (kbd "C-c G") 'prelude-google)
    (define-key prelude-mode-map (kbd "C-c s") 'rfnash-visit-scratch-buffer)
    (define-key prelude-mode-map (kbd "C-c S") 'prelude-swap-windows)
    (define-key prelude-mode-map (kbd "C-c ;") 'comment-region)
    (define-key prelude-mode-map (kbd "C-x t") 'my-open-calendar)
    (define-key prelude-mode-map (kbd "C-x x") 'sauron-toggle-hide-show)

    (define-key oog-map (kbd "C-n") 'oog-next-line)
    (define-key oog-map (kbd "C-p") 'oog-previous-line)
    (define-key oog-map (kbd "C-v") 'oog-previous-page)
    (define-key oog-map (kbd "M-v") 'oog-next-page)

    (require 'gnus-art)
    (define-key gnus-article-mode-map (kbd "i") 'gnus-article-show-images)
    (define-key gnus-summary-mode-map (kbd "i") 'gnus-article-show-images)

    ;; Use C-h instead of backspace, because I disable backspace in xbindkeys
    ;; Long story, but purpose was to stop its use in aldo
    ;; TODO: this probable is a horrible idea and should be removed
    (global-unset-key (kbd "C-h"))
    (define-key prelude-mode-map (kbd "C-h") 'backward-delete-char-untabify)
    (define-key helm-map (kbd "C-h") 'backward-delete-char)

    ;; TODO: kind of works, but usually ends up deleting characters
    ;; in the buffer I'm searching in, and not from the search string,
    ;; yet pressing backspace works as expected. Figure out why.
    (define-key isearch-mode-map (kbd "C-h") 'backward-delete-char)

    ;; (global-set-key "\C-cT" 'rfnash-visit-term-buffer)
    ;; (global-set-key "\C-ct" 'rfnash-visit-eshell-buffer)

    (global-set-key "\C-xcs" 'helm-surfraw)

  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:42]
  :END:
* remem
  My rememberance agent configuration.
  #+begin_src emacs-lisp
    (require 'prelude-mode)
    (add-to-list 'load-path "/usr/local/share/emacs/site-lisp/")
    (add-to-list 'load-path "/usr/share/emacs/site-lisp/")
    (define-key prelude-mode-map (kbd "C-c r") nil)
    (define-key global-map (kbd "C-c r") nil)
    ;; (setq remem-scopes-list '(("mail" 6 5 500)
    ;;                           ("notes" 2 5 500)))
    (setq remem-scopes-list '(("mail" 6 5 500)))
    ;;(load "remem")
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:42]
  :END:
* Gnus
  #+begin_src emacs-lisp
   (setq gnus-init-file (expand-file-name "rfnash-gnus.el" prelude-personal-dir))
   (require 'rfnash-gnus)
 #+end_src
  :PROPERTIES:
  :CREATED:  [2014-09-03 Wed 16:54]
  :END:
* EDBI
  #+begin_src emacs-lisp
    (prelude-require-packages '(edbi edbi-sqlite))
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-10-20 Mon 23:33]
  :END:
* Sauron
  #+begin_src emacs-lisp
    (prelude-require-package 'sauron)
    (sauron-start)
  #+end_src
  :PROPERTIES:
  :CREATED:  [2014-10-25 Sat 19:35]
  :END:
* Debug on error
  #+begin_src emacs-lisp
    (setq debug-on-error t)
  #+end_src

* Emacs Server
  Start the Emacs server if it isn't already running
  #+begin_src emacs-lisp
    (require 'server)
    (if (not (server-running-p server-name)) (server-start))
  #+end_src
